(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,s=window.wp.i18n,r=window.wp.blockEditor,a=window.wp.components,l=window.wp.element,i=window.wp.apiFetch;var o=e.n(i);const n=window.wp.blocks,c=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"custom-series/series-block","version":"1.0.0","title":"Series Block","category":"widgets","icon":"list-view","description":"Display posts from a selected series.","attributes":{"seriesName":{"type":"string","default":""},"showTitle":{"type":"boolean","default":true},"alignment":{"type":"string","default":""},"backgroundColor":{"type":"string","default":""},"textColor":{"type":"string","default":""},"borderColor":{"type":"string","default":""},"borderWidth":{"type":"string","default":""},"borderRadius":{"type":"string","default":""}},"supports":{"html":false,"align":true,"color":{"text":true,"background":true,"gradients":true},"spacing":{"margin":true,"padding":true},"typography":{"fontSize":true,"lineHeight":true}},"textdomain":"custom-series","editorScript":"file:./build/index.js","style":"file:./style-index.css","editorStyle":"file:./editor.css"}'),d=e=>{const{attributes:i,setAttributes:n}=e,{seriesName:c,showTitle:d,alignment:m}=i,[u,p]=(0,l.useState)([]),[g,w]=(0,l.useState)(!0),[b,h]=(0,l.useState)(null),[y,f]=(0,l.useState)([]),[v,_]=(0,l.useState)(!1),k=(0,r.useBlockProps)({className:"wp-block-custom-series-block"+(m?` align${m}`:"")}),E=(0,l.useCallback)((async()=>{try{w(!0);const e=await o()({path:"/wp/v2/posts?per_page=100&_fields=id,meta"}),t=[...new Set(e.map((e=>e.meta._series)).filter((e=>e&&e.length>0)))].sort();p(t),h(null)}catch(e){h(e.message)}finally{w(!1)}}),[]),S=(0,l.useCallback)((async e=>{if(e)try{_(!0);const t=(await o()({path:`/wp/v2/posts?per_page=100&meta_key=_series&meta_value=${encodeURIComponent(e)}&orderby=date&order=asc&_fields=id,title,link,date,meta`,parse:!0})).filter((t=>t.meta&&t.meta._series===e)).map((e=>{return{...e,title:(t=e.title,"string"==typeof t?t:t&&"object"==typeof t&&t.rendered?t.rendered:"")};var t}));f(t),h(null)}catch(e){h(e.message)}finally{_(!1)}}),[]);return(0,l.useEffect)((()=>{E()}),[E]),(0,l.useEffect)((()=>{c?S(c):f([])}),[c,S]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(r.InspectorControls,null,(0,t.createElement)(a.PanelBody,{title:(0,s.__)("Series Settings","custom-series")},(0,t.createElement)(a.SelectControl,{label:(0,s.__)("Select Series","custom-series"),value:c,options:[{label:(0,s.__)("Select a series","custom-series"),value:""},...u.map((e=>({label:e,value:e})))],onChange:e=>n({seriesName:e})}),(0,t.createElement)(a.ToggleControl,{label:(0,s.__)("Show Series Title","custom-series"),checked:d,onChange:e=>n({showTitle:e})}))),(0,t.createElement)("div",{...k},g?(0,t.createElement)("div",{className:"series-placeholder"},(0,s.__)("Loading series...","custom-series")):b?(0,t.createElement)("div",{className:"series-error"},(0,t.createElement)("div",{className:"error"},b)):c?v?(0,t.createElement)("div",{className:"series-placeholder"},(0,s.__)("Loading posts...","custom-series")):0===y.length?(0,t.createElement)("div",{className:"series-placeholder"},(0,s.__)("No posts found in this series","custom-series")):(0,t.createElement)(t.Fragment,null,d&&c&&(0,t.createElement)("h2",{className:"series-title"},c),(0,t.createElement)("div",{className:"series-posts"},(0,t.createElement)("div",{className:"series-posts-container","data-series":c}))):(0,t.createElement)("div",{className:"series-placeholder"},(0,s.__)("Select a series to display","custom-series"))))},m=({attributes:e})=>{const{seriesName:s,showTitle:a,alignment:l,backgroundColor:i,textColor:o,borderColor:n,borderWidth:c,borderRadius:d}=e,m={};i&&(m.backgroundColor=i),o&&(m.color=o),n&&(m.borderColor=n),c&&(m.borderWidth=c),d&&(m.borderRadius=d);const u=r.useBlockProps.save({className:"wp-block-custom-series-block"+(l?` align${l}`:""),style:m});return(0,t.createElement)("div",{...u},a&&s&&(0,t.createElement)("h2",{className:"series-title"},s),(0,t.createElement)("div",{className:"series-posts"},(0,t.createElement)("div",{className:"series-posts-container","data-series":s})))};(0,n.registerBlockType)(c.name,{...c,edit:d,save:m}),window.wp.customSeries={SeriesBlockEdit:d,SeriesBlockSave:m}})();