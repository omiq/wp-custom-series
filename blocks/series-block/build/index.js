(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,s=window.wp.blocks,r=window.wp.i18n,l=window.wp.blockEditor,a=window.wp.components,o=window.wp.element,n=window.wp.apiFetch;var i=e.n(n);window.wp.coreData,window.wp.data,(0,s.registerBlockType)("custom-series/series-block",{apiVersion:2,title:(0,r.__)("Series Block","custom-series"),description:(0,r.__)("Display posts from a selected series.","custom-series"),category:"widgets",icon:"list-view",supports:{html:!1,align:!0,color:{text:!0,background:!0,gradients:!0}},attributes:{seriesName:{type:"string",default:""},showTitle:{type:"boolean",default:!0},alignment:{type:"string",default:""},borderWidth:{type:"number",default:1},borderColor:{type:"string",default:"#ddd"},borderRadius:{type:"number",default:4},padding:{type:"number",default:24},margin:{type:"number",default:32}},edit:e=>{const{attributes:s,setAttributes:n}=e,{seriesName:d,showTitle:c,alignment:m,textColor:u,backgroundColor:p}=s,[b,g]=(0,o.useState)([]),[_,v]=(0,o.useState)(!0),[w,h]=(0,o.useState)(null),[E,C]=(0,o.useState)([]),[f,y]=(0,o.useState)(!1),x=(0,l.useBlockProps)({className:"wp-block-custom-series-block"+(m?` align${m}`:""),style:{borderWidth:s.borderWidth?`${s.borderWidth}px`:void 0,borderColor:s.borderColor||void 0,borderRadius:s.borderRadius?`${s.borderRadius}px`:void 0,padding:s.padding?`${s.padding}px`:void 0,margin:s.margin?`${s.margin}px`:void 0}});(0,o.useEffect)((()=>{k()}),[]),(0,o.useEffect)((()=>{d&&S()}),[d]);const k=async()=>{try{v(!0);const e=await i()({path:"/wp/v2/posts?per_page=100&_fields=id,meta"}),t=[...new Set(e.map((e=>e.meta._series)).filter((e=>e&&e.length>0)))].sort();g(t),h(null)}catch(e){h(e.message)}finally{v(!1)}},S=async()=>{try{y(!0),console.log("Fetching posts for series:",d);const e=await i()({path:`/wp/v2/posts?per_page=100&meta_key=_series&meta_value=${encodeURIComponent(d)}`});console.log("Posts fetched:",e);const t=e.filter((e=>e.meta&&e.meta._series===d));console.log("Filtered posts:",t),C(t),h(null)}catch(e){console.error("Error fetching posts:",e),h(e.message)}finally{y(!1)}};return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.InspectorControls,null,(0,t.createElement)(a.PanelBody,{title:(0,r.__)("Series Settings","custom-series")},(0,t.createElement)(a.SelectControl,{label:(0,r.__)("Select Series","custom-series"),value:d,options:[{label:(0,r.__)("Select a series","custom-series"),value:""},...b.map((e=>({label:e,value:e})))],onChange:e=>n({seriesName:e})}),(0,t.createElement)(a.ToggleControl,{label:(0,r.__)("Show Series Title","custom-series"),checked:c,onChange:e=>n({showTitle:e})})),(0,t.createElement)(a.PanelBody,{title:(0,r.__)("Styles","custom-series"),initialOpen:!1},(0,t.createElement)(a.SelectControl,{label:(0,r.__)("Alignment","custom-series"),value:m,options:[{label:(0,r.__)("Left","custom-series"),value:"left"},{label:(0,r.__)("Center","custom-series"),value:"center"},{label:(0,r.__)("Right","custom-series"),value:"right"}],onChange:e=>n({alignment:e})}),(0,t.createElement)(a.RangeControl,{label:(0,r.__)("Border Width","custom-series"),value:s.borderWidth||0,onChange:e=>n({borderWidth:e}),min:0,max:10,allowReset:!0}),(0,t.createElement)("div",{className:"components-base-control"},(0,t.createElement)("label",{className:"components-base-control__label"},(0,r.__)("Border Color","custom-series")),(0,t.createElement)(a.ColorPicker,{color:s.borderColor||"#000000",onChangeComplete:e=>n({borderColor:e.hex})})),(0,t.createElement)(a.RangeControl,{label:(0,r.__)("Border Radius","custom-series"),value:s.borderRadius||0,onChange:e=>n({borderRadius:e}),min:0,max:20,allowReset:!0}),(0,t.createElement)(a.__experimentalUnitControl,{label:(0,r.__)("Padding","custom-series"),value:s.padding||24,onChange:e=>n({padding:parseInt(e)}),units:[{value:"px",label:"px"},{value:"%",label:"%"},{value:"em",label:"em"},{value:"rem",label:"rem"}],min:0,max:100}),(0,t.createElement)(a.__experimentalUnitControl,{label:(0,r.__)("Margin","custom-series"),value:s.margin||32,onChange:e=>n({margin:parseInt(e)}),units:[{value:"px",label:"px"},{value:"%",label:"%"},{value:"em",label:"em"},{value:"rem",label:"rem"}],min:0,max:100}))),(0,t.createElement)("div",{...x},_?(0,t.createElement)("p",null,(0,r.__)("Loading series...","custom-series")):w?(0,t.createElement)("p",{className:"error"},w):(0,t.createElement)(t.Fragment,null,c&&d&&(0,t.createElement)("h2",{className:"series-title"},d),f?(0,t.createElement)("p",null,(0,r.__)("Loading posts...","custom-series")):E.length>0?(0,t.createElement)("ul",{className:"series-posts"},E.map((e=>(0,t.createElement)("li",{key:e.id},(0,t.createElement)("a",{href:e.link},e.title.rendered))))):d&&(0,t.createElement)("p",null,(0,r.__)("No posts found in this series.","custom-series")))))},save:({attributes:e})=>{const{seriesName:s,showTitle:r,alignment:a,borderWidth:o,borderColor:n,borderRadius:i,padding:d,margin:c}=e,m=l.useBlockProps.save({className:"wp-block-custom-series-block"+(a?` align${a}`:""),style:{borderWidth:o?`${o}px`:void 0,borderColor:n||void 0,borderRadius:i?`${i}px`:void 0,padding:d?`${d}px`:void 0,margin:c?`${c}px`:void 0}});return(0,t.createElement)("div",{...m},r&&s&&(0,t.createElement)("h2",{className:"series-title"},s),(0,t.createElement)("div",{className:"series-posts"},(0,t.createElement)("div",{className:"series-posts-container","data-series":s})))}})})();